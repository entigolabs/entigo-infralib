alloy:
  crds:
    create: false

  priorityClassName: "alloy"

  alloy:
    configMap:
      create: true
      content: ""

    mounts:
      varlog: true

    resources:
      requests:
        cpu: "50m"
        memory: "128Mi"
        ephemeral-storage: "128Mi"
      limits:
        cpu: "500m"
        memory: "512Mi"
        ephemeral-storage: "50Gi"

    livenessProbe:
      httpGet:
        path: /-/healthy
        port: 12345
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3

    enableHttpServerPort: false
    enableReporting: false

  service:
    enabled: false

  serviceAccount:
    create: true
    annotations: {}

  configReloader:
    enabled: true
    resources:
      requests:
        cpu: "10m"
        memory: "32Mi"
        ephemeral-storage: "50Mi"
      limits:
        cpu: "100m"
        memory: "128Mi"
        ephemeral-storage: "100Mi"

  networkPolicy:
    enabled: true
    flavor: kubernetes
    policyTypes:
      - Ingress
      - Egress
    ingress: []
    egress:
      - ports:
          - port: 53
            protocol: UDP
          - port: 53
            protocol: TCP
        to:
          - namespaceSelector:
              matchLabels:
                kubernetes.io/metadata.name: kube-system
      - ports:
          - port: 80
            protocol: TCP
          - port: 8080
            protocol: TCP
        to:
          - namespaceSelector: {}
            podSelector:
              matchLabels:
                app.kubernetes.io/name: loki
                app.kubernetes.io/component: gateway

  controller:
    type: "daemonset"
    replicas: 1
    tolerations:
      - key: "mon"
        operator: "Equal"
        value: "true"
        effect: "NoSchedule"
      - key: "tools"
        operator: "Equal"
        value: "true"
        effect: "NoSchedule"
    affinity:
      nodeAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 90
            preference:
              matchExpressions:
                - key: mon
                  operator: In
                  values:
                    - "true"
          - weight: 10
            preference:
              matchExpressions:
                - key: tools
                  operator: In
                  values:
                    - "true"
