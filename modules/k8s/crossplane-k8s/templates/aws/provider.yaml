{{- if and (eq .Values.cloudProvider "aws") .Values.installProvider }}

apiVersion: pkg.crossplane.io/v1
kind: Provider
metadata:
  name: k8s-{{ .Release.Name }}
  annotations:
    argocd.argoproj.io/sync-wave: '2'
    helm.sh/resource-policy: keep
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
spec:
  package: xpkg.upbound.io/crossplane-contrib/provider-kubernetes:v0.13.0
  runtimeConfigRef:
    name: k8s-{{ .Release.Name }}

{{- end }}